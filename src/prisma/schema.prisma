// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  binaryTargets = ["native", "darwin", "darwin-arm64", "linux-musl", "debian-openssl-1.1.x", "darwin"]
  previewFeatures = ["interactiveTransactions"]
}

datasource db {
  provider = "postgresql"
  url      = "postgresql://rubcamp:rubcamp123@db:5432/rubcamp?schema=public&connection_timeout=300"  //env("DATABASE_URL")
}


model Usuario {
  usu_cadastro String   @id @unique 
  usu_nome     String
  usu_email    String
  usu_telefone String
  usu_dtNasc   DateTime
  usu_senha    String
  endereco     Endereco[]
  contas       Conta?
}

model Endereco {
  usu_cadastro   String    @id @unique 
  end_cep        String
  end_rua        String
  end_num        Int
  end_bairro     String
  end_cidade     String
  end_uf         String
  end_complemento String?
  usuario        Usuario   @relation(fields: [usu_cadastro], references: [usu_cadastro])
}

model Conta {
  usu_cadastro String       @id @unique
  con_id       Int          @default(autoincrement()) @unique
  con_num      Int
  con_agencia  String
  con_tipo     String
  con_extrato  Float
  con_senha    BigInt
  usuario      Usuario      @relation(fields: [usu_cadastro], references: [usu_cadastro])
  agencia      Agencia?
  transferenciasRemetente   Transferencia[] @relation("Remetente")
  transferenciasDestinatario Transferencia[] @relation("Destinatario")
}

model Agencia {
  con_id    Int    @unique
  age_num   BigInt
  age_nome  String @id @unique
  conta     Conta @relation(fields: [con_id], references: [con_id])
}

model Transferencia {
  trans_id         Int      @id @unique
  trans_remetente  Int
  trans_destinatario Int
  trans_val        Float
  trans_dtTrans    DateTime
  remetente        Conta    @relation("Remetente", fields: [trans_remetente], references: [con_id])
  destinatario     Conta    @relation("Destinatario", fields: [trans_destinatario], references: [con_id])
}